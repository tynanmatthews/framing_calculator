{% extends 'base.html' %} {% block title %}Create New Job{% endblock %} {% block content %}
<h1 class="display-1">Create New Job</h1>

<form method="post">
    <!-- cross site request forgery token, important for security -->
    {% csrf_token %}
    <h2>Customer Details</h2>
    <!-- Collect all the customer details, these can be used to auto query DB -->
    <div class="mb-3 form-group">
        <label class="form-label" for="customer_fname">First Name</label>
        <input class="form-control" id="customer_fname" type="text"/>
        <label class="form-label" for="customer_lname">Last Name</label>
        <input class="form-control" id="customer_lname" type="text"/>
    </div>
    <div class="mb-3 form-group">
        <label class="form-label" for="customer_phone_number">Phone Number</label>
        <input class="form-control" id="customer_phone_number" type="tel">
    </div>
    <div class="mb-3 form-group">
        <label class="form-label" for="customer_email">Email Address</label>
        <input class="form-control" id="customer_email" type="email" placeholder="someone@example.com">
    </div>
    <div class="mb-3 form-group">
        <label class="form-label" for="customer_address">Address</label>
        <input class="form-control" id="customer_address" type="text">
    </div>

    <h2>Job Details</h2>
    {{ job_form.non_field_errors }}

    <div class="mb-3 form-group">
        <!-- Each of the sub div's provide a place to inject html if box is checked -->
        <div>
            <label class="form-label" for="require_mat">Does this item require a mat?</label>
            <input class="checkbox" id="require_mat" type="checkbox"/>
        </div>

        <div>
            <label class="form-label" for="require_frame">Is the item being framed?</label>
            <input class="checkbox" id="require_frame" type="checkbox"/>
        </div>

        <div>
            <label class="form-label" for="require_glass">Does the item require glass/acrylic?</label>
            <input class="checkbox" id="require_glass" type="checkbox"/>
        </div>

        <div>
            <label class="form-label" for="require_stretch">Is the item being stretched?</label>
            <input class="checkbox" id="require_stretch" type="checkbox"/>
        </div>

        <div>
            <label class="form-label" for="require_caption">Is a caption required?</label>
            <input class="checkbox" id="require_caption" type="checkbox"/>
        </div>

        <div>
            <label class="form-label" for="require_laminate">Is the item being laminated?</label>
            <input class="checkbox" id="require_laminate" type="checkbox"/>
        </div>
    </div>

    <!-- Below this point is the Claude genned form, useful for ideas, not for production -->
    <div class="mb-3 form-group">
        {{ job_form.customer.errors }}
        <label class="form-label" for="{{ job_form.customer.id_for_label }}">Customer:</label>
        {{ job_form.customer}}
    </div>

    <div class="form-group">
        {{ job_form.description.errors }}
        <label for="{{ job_form.description.id_for_label }}">Description:</label>
        {{ job_form.description }}
    </div>

    <h2>Job Components</h2>
    {{ job_component_form }}

    <div id="frames">
        <h3>Frames</h3>
        <div class="frame-component">
            <select name="frame_material" required>
                <option value="">Select Frame Material</option>
                {% for material in frame_materials %}
                <option value="{{ material.id }}">
                    {{ material.name }} - {{ material.code }}
                </option>
                {% endfor %}
            </select>
            <input
                type="number"
                name="frame_quantity"
                value="1"
                min="1"
                required
            />
            <button type="button" class="add-frame">Add Another Frame</button>
        </div>
    </div>

    <div id="mats">
        <h3>Mats</h3>
        <div class="mat-component">
            <select name="mat_material" required>
                <option value="">Select Mat Material</option>
                {% for material in mat_materials %}
                <option value="{{ material.id }}">
                    {{ material.name }} - {{ material.code }}
                </option>
                {% endfor %}
            </select>
            <input
                type="number"
                name="mat_quantity"
                value="1"
                min="1"
                required
            />
            <button type="button" class="add-mat">Add Another Mat</button>
        </div>
    </div>

    <div id="glass">
        <h3>Glass</h3>
        <div class="glass-component">
            <select name="glass_material" required>
                <option value="">Select Glass Type</option>
                {% for material in glass_materials %}
                <option value="{{ material.id }}">
                    {{ material.name }} - {{ material.code }}
                </option>
                {% endfor %}
            </select>
            <input
                type="number"
                name="glass_quantity"
                value="1"
                min="1"
                required
            />
        </div>
    </div>

    <h3>Mat Window</h3>
    {{ mat_window_form }}
    <div id="mat-window">
        <!-- Below is the Claude form -->
        <input
            type="number"
            name="mat_window_width"
            placeholder="Width"
            required
        />
        <input
            type="number"
            name="mat_window_height"
            placeholder="Height"
            required
        />
        <input
            type="number"
            name="mat_window_x"
            placeholder="X Position"
            required
        />
        <input
            type="number"
            name="mat_window_y"
            placeholder="Y Position"
            required
        />
    </div>

    <button type="submit" class="btn btn-lg btn-primary">Create Job</button>
</form>

{% endblock %} {% block extra_js %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const addFrameButton = document.querySelector(".add-frame");
        const addMatButton = document.querySelector(".add-mat");

        addFrameButton.addEventListener("click", function () {
            const frameComponent = document
                .querySelector(".frame-component")
                .cloneNode(true);
            document.getElementById("frames").appendChild(frameComponent);
        });

        addMatButton.addEventListener("click", function () {
            const matComponent = document
                .querySelector(".mat-component")
                .cloneNode(true);
            document.getElementById("mats").appendChild(matComponent);
        });
    });
</script>
{% endblock %}
